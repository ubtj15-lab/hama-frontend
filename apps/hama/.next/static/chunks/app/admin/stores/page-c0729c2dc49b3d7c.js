(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[690],{9833:function(e,t,n){Promise.resolve().then(n.bind(n,4032))},4032:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var o=n(7573),r=n(7653),i=n(8146);function l(){var e;let[t,n]=(0,r.useState)(""),[l,a]=(0,r.useState)([]),[s,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),[f,p]=(0,r.useState)([]),[x,y]=(0,r.useState)(!1),[b,h]=(0,r.useState)(null),[m,g]=(0,r.useState)(null),[j,S]=(0,r.useState)(!1),[k,v]=(0,r.useState)(null),w=(0,r.useRef)(null),z=(0,r.useRef)(null),C=(0,r.useCallback)(async e=>{d(!0);try{var t;let n=await fetch("/api/admin/stores?q=".concat(encodeURIComponent(e),"&limit=30")),o=await n.json();a(null!==(t=o.stores)&&void 0!==t?t:[])}catch(e){a([])}finally{d(!1)}},[]),T=(0,r.useCallback)(async e=>{y(!0);try{var t;let n=await fetch("/api/admin/users?q=".concat(encodeURIComponent(e),"&limit=30")),o=await n.json();p(null!==(t=o.users)&&void 0!==t?t:[])}catch(e){p([])}finally{y(!1)}},[]);(0,r.useEffect)(()=>(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{C(t)},t.trim()?300:0),()=>{w.current&&clearTimeout(w.current)}),[t,C]),(0,r.useEffect)(()=>(z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{c.trim()?T(c):p([])},c.trim()?300:0),()=>{z.current&&clearTimeout(z.current)}),[c,T]);let B=async()=>{if(b){S(!0),v(null);try{let e=await fetch("/api/admin/stores/".concat(b.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({owner_id:m})}),t=await e.json();if(!e.ok){v({type:"err",text:t.error||"저장 실패"});return}v({type:"ok",text:"저장했어요."}),h(e=>e?{...e,owner_id:m}:null)}catch(e){v({type:"err",text:"저장 중 오류"})}finally{S(!1)}}},R=async()=>{if(b){g(null),S(!0),v(null);try{let e=await fetch("/api/admin/stores/".concat(b.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({owner_id:null})}),t=await e.json();if(!e.ok){v({type:"err",text:t.error||"해제 실패"});return}v({type:"ok",text:"연결 해제했어요."}),h(e=>e?{...e,owner_id:null}:null)}catch(e){v({type:"err",text:"오류"})}finally{S(!1)}}};return(0,o.jsxs)("main",{style:{maxWidth:560,margin:"0 auto",padding:24,fontFamily:"Noto Sans KR, system-ui, sans-serif"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24,flexWrap:"wrap",gap:12},children:[(0,o.jsx)("h1",{style:{margin:0,fontSize:20,fontWeight:800},children:"매장 \xb7 매장주 연결"}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[(0,o.jsx)(i.default,{href:"/admin",style:{fontSize:14,color:"#2563eb",textDecoration:"none"},children:"통계 대시보드"}),(0,o.jsx)("a",{href:"/partner",target:"_blank",rel:"noopener noreferrer",style:{fontSize:14,color:"#2563eb",textDecoration:"none",fontWeight:600},children:"매장주 대시보드"}),(0,o.jsx)(i.default,{href:"/admin/reservations",style:{fontSize:14,color:"#2563eb",textDecoration:"none"},children:"예약 목록"})]})]}),(0,o.jsxs)("section",{style:{marginBottom:24},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#475569",marginBottom:8},children:"매장 검색"}),(0,o.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"매장명 입력",style:{width:"100%",padding:"12px 14px",borderRadius:12,border:"1px solid #e2e8f0",fontSize:14,boxSizing:"border-box"}}),s&&(0,o.jsx)("div",{style:{fontSize:12,color:"#64748b",marginTop:6},children:"검색 중..."}),(0,o.jsx)("div",{style:{marginTop:10},children:l.slice(0,15).map(e=>{var t;return(0,o.jsxs)("button",{type:"button",onClick:()=>{h(e),g(e.owner_id),u(""),p([]),v(null)},style:{display:"block",width:"100%",padding:"10px 12px",marginBottom:6,textAlign:"left",border:"1px solid #e2e8f0",borderRadius:10,background:(null==b?void 0:b.id)===e.id?"#EFF6FF":"#fff",cursor:"pointer",fontSize:13},children:[(0,o.jsx)("span",{style:{fontWeight:600},children:null!==(t=e.name)&&void 0!==t?t:"(이름 없음)"}),e.category&&(0,o.jsx)("span",{style:{color:"#64748b",marginLeft:8},children:e.category}),e.owner_id&&(0,o.jsx)("span",{style:{display:"block",fontSize:11,color:"#16a34a",marginTop:2},children:"연결됨"})]},e.id)})})]}),b&&(0,o.jsxs)("section",{style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#64748b",marginBottom:4},children:"선택한 매장"}),(0,o.jsx)("div",{style:{fontSize:16,fontWeight:700,marginBottom:16},children:null!==(e=b.name)&&void 0!==e?e:"(이름 없음)"}),(0,o.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#475569",marginBottom:8},children:"매장주(유저) 검색 후 선택"}),(0,o.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"닉네임 입력",style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e2e8f0",fontSize:14,marginBottom:10,boxSizing:"border-box"}}),x&&(0,o.jsx)("div",{style:{fontSize:12,color:"#64748b",marginBottom:8},children:"검색 중..."}),(0,o.jsx)("div",{style:{marginBottom:12,maxHeight:200,overflowY:"auto"},children:f.map(e=>{var t;return(0,o.jsxs)("button",{type:"button",onClick:()=>g(e.id),style:{display:"block",width:"100%",padding:"8px 12px",marginBottom:4,textAlign:"left",border:"none",borderRadius:8,background:m===e.id?"#DBEAFE":"#fff",cursor:"pointer",fontSize:13,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[null!==(t=e.nickname)&&void 0!==t?t:"(닉네임 없음)"," ",(0,o.jsxs)("span",{style:{fontSize:11,color:"#94a3b8"},children:["(",e.id.slice(0,8),"…)"]})]},e.id)})}),k&&(0,o.jsx)("div",{style:{padding:10,borderRadius:8,marginBottom:12,background:"ok"===k.type?"#dcfce7":"#fee2e2",color:"ok"===k.type?"#166534":"#b91c1c",fontSize:13},children:k.text}),(0,o.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[(0,o.jsx)("button",{type:"button",onClick:B,disabled:j,style:{padding:"10px 18px",borderRadius:10,border:"none",background:"#2563eb",color:"#fff",fontSize:14,fontWeight:600,cursor:j?"not-allowed":"pointer"},children:j?"저장 중…":"연결 저장"}),(0,o.jsx)("button",{type:"button",onClick:R,disabled:j,style:{padding:"10px 18px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",color:"#64748b",fontSize:14,cursor:j?"not-allowed":"pointer"},children:"연결 해제"})]})]}),(0,o.jsxs)("p",{style:{fontSize:12,color:"#94a3b8",marginTop:24},children:['매장을 검색해 선택한 뒤, 매장주로 연결할 유저를 검색해 선택하고 "연결 저장"을 누르세요. 위 "매장주 대시보드" 링크로 이동한 뒤 ',(0,o.jsx)("strong",{children:"카카오 로그인"}),"하면, 그 계정에 연결된 매장의 통계를 볼 수 있어요."]})]})}}},function(e){e.O(0,[146,293,528,744],function(){return e(e.s=9833)}),_N_E=e.O()}]);