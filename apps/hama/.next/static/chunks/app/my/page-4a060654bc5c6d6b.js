(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[782],{5454:function(e,n,t){Promise.resolve().then(t.bind(t,6019))},3123:function(e,n,t){"use strict";t.d(n,{X:function(){return r}});var l=t(7653),i=t(5708),o=t(5099);function r(){let[e,n]=(0,l.useState)([]),[t,r]=(0,l.useState)(!1),d=(0,o.n)(),a=(0,l.useCallback)(async()=>{if(!(!d||d.startsWith("server"))){r(!0);try{var e;let t=await fetch("/api/recent?user_id=".concat(encodeURIComponent(d),"&limit=20")),l=await t.json(),o=null!==(e=l.stores)&&void 0!==e?e:[];n(o.map(e=>(0,i.O)(e)))}catch(e){n([])}finally{r(!1)}}},[d]),u=(0,l.useCallback)(async e=>{if(!(!d||d.startsWith("server")))try{await fetch("/api/recent/record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:d,store_id:e})}),await a()}catch(e){}},[d,a]);return(0,l.useEffect)(()=>{a()},[a]),{recentCards:e,loading:t,recordView:u,refetch:a}}},5142:function(e,n,t){"use strict";t.d(n,{F:function(){return r}});var l=t(7653),i=t(5708),o=t(5099);function r(){let[e,n]=(0,l.useState)(new Set),[t,r]=(0,l.useState)([]),[d,a]=(0,l.useState)(!1),u=(0,o.n)(),s=(0,l.useCallback)(async()=>{if(!(!u||u.startsWith("server"))){a(!0);try{var e,t;let l=await fetch("/api/saved?user_id=".concat(encodeURIComponent(u))),o=await l.json();n(new Set(null!==(e=o.saved_ids)&&void 0!==e?e:[])),r((null!==(t=o.stores)&&void 0!==t?t:[]).map(e=>(0,i.O)(e)))}catch(e){n(new Set),r([])}finally{a(!1)}}},[u]),c=(0,l.useCallback)(async t=>{if(!u||u.startsWith("server"))return!1;let l=e.has(t);n(e=>{let n=new Set(e);return l?n.delete(t):n.add(t),n});try{let e=await fetch("/api/saved",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:u,store_id:t})}),i=await e.json();if(!i.ok)return n(e=>{let n=new Set(e);return l?n.add(t):n.delete(t),n}),l;return i.saved}catch(e){return n(e=>{let n=new Set(e);return l?n.add(t):n.delete(t),n}),l}},[u,e]),v=(0,l.useCallback)(n=>e.has(n),[e]);return(0,l.useEffect)(()=>{s()},[s]),{savedIds:e,savedCards:t,loading:d,toggleSaved:c,isSaved:v,refetch:s}}},1342:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});let l="hama_session_id";function i(){try{let i=window.localStorage.getItem(l);if(!i){var e,n,t;i=null!==(t=null===(e=(n=crypto).randomUUID)||void 0===e?void 0:e.call(n))&&void 0!==t?t:"sess_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,10)),window.localStorage.setItem(l,i)}return i}catch(e){return""}}},5099:function(e,n,t){"use strict";t.d(n,{n:function(){return i}});var l=t(1342);function i(){try{let e=window.localStorage.getItem("hamaLoggedIn");if("1"===e){let e=window.localStorage.getItem("hamaUser");if(e){let n=JSON.parse(e),t=null==n?void 0:n.user_id;if(t)return"user_".concat(t)}}return"session_".concat((0,l.Z)())}catch(e){return"session_".concat((0,l.Z)())}}},5708:function(e,n,t){"use strict";function l(e){let n=String(null!=e?e:"").toLowerCase().trim();return"beauty"===n?"salon":"fd6"===n?"restaurant":"ce7"===n?"cafe":"bk9"===n?"salon":"at4"===n?"activity":n.includes("미용")||n.includes("헤어")||n.includes("이발")?"salon":n.includes("카페")||n.includes("커피")?"cafe":n.includes("식당")||n.includes("음식")||n.includes("레스토랑")||n.includes("맛집")?"restaurant":n.includes("액티비")||n.includes("활동")||n.includes("체험")||n.includes("공원")?"activity":"restaurant"===n||"cafe"===n||"salon"===n||"activity"===n?n:"restaurant"}function i(e){var n,t,i,o,r,d,a,u,s,c,v,f,g,h,p,m,y,b,x,S,j,w,k,_,C,W,z,I,R,F,O,N,U,E,L,P,B,T;let A=String(null!==(i=null!==(t=null!==(n=null==e?void 0:e.id)&&void 0!==n?n:null==e?void 0:e.store_id)&&void 0!==t?t:null==e?void 0:e.storeId)&&void 0!==i?i:"").trim(),K=String(null!==(d=null!==(r=null!==(o=null==e?void 0:e.name)&&void 0!==o?o:null==e?void 0:e.store_name)&&void 0!==r?r:null==e?void 0:e.storeName)&&void 0!==d?d:"").trim(),q=l(null!==(v=null!==(c=null!==(s=null!==(u=null!==(a=null==e?void 0:e.category)&&void 0!==a?a:null==e?void 0:e.categoryNorm)&&void 0!==u?u:null==e?void 0:e.category_norm)&&void 0!==s?s:null==e?void 0:e.tab)&&void 0!==c?c:null==e?void 0:e.type)&&void 0!==v?v:null==e?void 0:e.kind),D=String(null!==(g=null!==(f=null==e?void 0:e.categoryLabel)&&void 0!==f?f:null==e?void 0:e.category_label)&&void 0!==g?g:function(e){let n=l(e);return"restaurant"===n?"식당":"cafe"===n?"카페":"salon"===n?"미용실":"액티비티"}(q)),J=Number(null!==(p=null!==(h=null==e?void 0:e.distanceKm)&&void 0!==h?h:null==e?void 0:e.distance_km)&&void 0!==p?p:"number"==typeof(null==e?void 0:e.distance)?e.distance/1e3:void 0),Z=Number.isFinite(J)?J:0,M=String(null!==(j=null!==(S=null!==(x=null!==(b=null!==(y=null!==(m=null==e?void 0:e.cover_image_url)&&void 0!==m?m:null==e?void 0:e.imageUrl)&&void 0!==y?y:null==e?void 0:e.image_url)&&void 0!==b?b:null==e?void 0:e.image)&&void 0!==x?x:null==e?void 0:e.thumbnail)&&void 0!==S?S:null==e?void 0:e.thumb)&&void 0!==j?j:""),Q="number"==typeof(null==e?void 0:e.lat)?e.lat:"number"==typeof(null==e?void 0:e.latitude)?e.latitude:null!==(k=null!==(w=null==e?void 0:e.lat)&&void 0!==w?w:null==e?void 0:e.latitude)&&void 0!==k?k:null,X="number"==typeof(null==e?void 0:e.lng)?e.lng:"number"==typeof(null==e?void 0:e.longitude)?e.longitude:null!==(C=null!==(_=null==e?void 0:e.lng)&&void 0!==_?_:null==e?void 0:e.longitude)&&void 0!==C?C:null;return{id:A,name:K,category:q,categoryLabel:D,distanceKm:Z,moodText:String(null!==(I=null!==(z=null!==(W=null==e?void 0:e.moodText)&&void 0!==W?W:null==e?void 0:e.mood_text)&&void 0!==z?z:null==e?void 0:e.mood)&&void 0!==I?I:""),imageUrl:M,quickQuery:String(null!==(F=null!==(R=null==e?void 0:e.quickQuery)&&void 0!==R?R:null==e?void 0:e.quick_query)&&void 0!==F?F:K),lat:Q,lng:X,mood:null!==(O=null==e?void 0:e.mood)&&void 0!==O?O:null,withKids:null!==(U=null!==(N=null==e?void 0:e.withKids)&&void 0!==N?N:null==e?void 0:e.with_kids)&&void 0!==U?U:null,forWork:null!==(L=null!==(E=null==e?void 0:e.forWork)&&void 0!==E?E:null==e?void 0:e.for_work)&&void 0!==L?L:null,priceLevel:null!==(B=null!==(P=null==e?void 0:e.priceLevel)&&void 0!==P?P:null==e?void 0:e.price_level)&&void 0!==B?B:null,tags:null!==(T=null==e?void 0:e.tags)&&void 0!==T?T:null}}t.d(n,{O:function(){return i}})},6019:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var l=t(7573);t(7653);var i=t(294),o=t(1695),r=t(5142),d=t(3123);function a(e){var n,t,l;return null!==(l=null!==(t=null!==(n=e.imageUrl)&&void 0!==n?n:e.image)&&void 0!==t?t:e.image_url)&&void 0!==l?l:"/images/category/restaurant.jpg"}function u(){let e=(0,o.useRouter)(),{savedCards:n,loading:t,toggleSaved:u,isSaved:s,refetch:c}=(0,r.F)(),{recentCards:v,loading:f,recordView:g,refetch:h}=(0,d.X)(),p=async n=>{await g(n.id),e.push("/?open=".concat(encodeURIComponent(n.id)))};return(0,l.jsx)("main",{style:{minHeight:"100vh",background:"linear-gradient(180deg, #F8FAFC 0%, #EEF2FF 100%)",fontFamily:"Noto Sans KR, system-ui, sans-serif"},children:(0,l.jsxs)("div",{style:{maxWidth:430,margin:"0 auto",padding:"24px 16px 40px"},children:[(0,l.jsxs)("header",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,l.jsx)("button",{type:"button",onClick:()=>e.back(),style:{border:"none",borderRadius:999,padding:"8px 14px",background:"#ffffff",boxShadow:"0 4px 12px rgba(15,23,42,0.1)",cursor:"pointer",fontSize:13,fontWeight:600},children:"← 뒤로"}),(0,l.jsx)("h1",{style:{fontSize:18,fontWeight:800,color:"#111827",margin:0},children:"마이"}),(0,l.jsx)("div",{style:{width:56}})]}),(0,l.jsxs)("section",{style:{marginBottom:28},children:[(0,l.jsx)("h2",{style:{fontSize:15,fontWeight:700,color:"#64748b",marginBottom:12,display:"flex",alignItems:"center",gap:6},children:"저장한 카드"}),t?(0,l.jsx)("div",{style:{padding:24,textAlign:"center",color:"#94a3b8",fontSize:13},children:"불러오는 중..."}):0===n.length?(0,l.jsxs)("div",{style:{padding:24,background:"#ffffff",borderRadius:16,textAlign:"center",color:"#94a3b8",fontSize:13,boxShadow:"0 4px 12px rgba(15,23,42,0.08)"},children:["저장한 카드가 없어요.",(0,l.jsx)("br",{}),"홈이나 검색에서 ♡를 눌러 저장해 보세요!"]}):(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:n.map(e=>{var n,t,o;return(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,background:"#ffffff",borderRadius:16,overflow:"hidden",boxShadow:"0 4px 12px rgba(15,23,42,0.08)",cursor:"pointer"},onClick:()=>p(e),children:[(0,l.jsx)("div",{style:{width:72,height:72,flexShrink:0,position:"relative",background:"#111827"},children:(0,l.jsx)(i.default,{src:a(e),alt:null!==(n=e.name)&&void 0!==n?n:"",fill:!0,style:{objectFit:"cover"}})}),(0,l.jsxs)("div",{style:{flex:1,minWidth:0,padding:"12px 0"},children:[(0,l.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:4},children:e.name}),(0,l.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:null!==(o=null!==(t=e.categoryLabel)&&void 0!==t?t:e.category)&&void 0!==o?o:""})]}),(0,l.jsx)("button",{type:"button",onClick:n=>{n.stopPropagation(),u(e.id),c()},style:{marginRight:12,border:"none",background:"none",cursor:"pointer",fontSize:20,color:s(e.id)?"#f43f5e":"#cbd5e1"},children:s(e.id)?"♥":"♡"})]},e.id)})})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h2",{style:{fontSize:15,fontWeight:700,color:"#64748b",marginBottom:12},children:"최근 본 카드"}),f?(0,l.jsx)("div",{style:{padding:24,textAlign:"center",color:"#94a3b8",fontSize:13},children:"불러오는 중..."}):0===v.length?(0,l.jsxs)("div",{style:{padding:24,background:"#ffffff",borderRadius:16,textAlign:"center",color:"#94a3b8",fontSize:13,boxShadow:"0 4px 12px rgba(15,23,42,0.08)"},children:["최근 본 카드가 없어요.",(0,l.jsx)("br",{}),"홈이나 검색에서 카드를 눌러보세요!"]}):(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:v.map(e=>{var n,t,o;return(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,background:"#ffffff",borderRadius:16,overflow:"hidden",boxShadow:"0 4px 12px rgba(15,23,42,0.08)",cursor:"pointer"},onClick:()=>p(e),children:[(0,l.jsx)("div",{style:{width:72,height:72,flexShrink:0,position:"relative",background:"#111827"},children:(0,l.jsx)(i.default,{src:a(e),alt:null!==(n=e.name)&&void 0!==n?n:"",fill:!0,style:{objectFit:"cover"}})}),(0,l.jsxs)("div",{style:{flex:1,minWidth:0,padding:"12px 12px 12px 0"},children:[(0,l.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:4},children:e.name}),(0,l.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:null!==(o=null!==(t=e.categoryLabel)&&void 0!==t?t:e.category)&&void 0!==o?o:""})]}),(0,l.jsx)("button",{type:"button",onClick:n=>{n.stopPropagation(),u(e.id),c(),h()},style:{marginRight:12,border:"none",background:"none",cursor:"pointer",fontSize:20,color:s(e.id)?"#f43f5e":"#cbd5e1"},children:s(e.id)?"♥":"♡"})]},e.id)})})]})]})})}},4125:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"RouterContext",{enumerable:!0,get:function(){return l}});let l=t(1887)._(t(7653)).default.createContext(null)}},function(e){e.O(0,[399,293,528,744],function(){return e(e.s=5454)}),_N_E=e.O()}]);